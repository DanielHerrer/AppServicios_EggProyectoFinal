<!-- @format -->

<!DOCTYPE html>
<html
	lang="es"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
	<head>
		<meta charset="UTF-8" />
		<title>Test Listar Servicios</title>
		<!-- Bootstrap -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
			  integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css"
		/>
		<link rel="stylesheet" href="/css/style.css" />
	</head>
	<body>
		<div class="row row-cols-1 row-cols-md-3 g-5">
			<div
				th:each="servicio, iterStat : ${servicios}"
				class="col-lg-4 col-md-6 col-sm-12"
			>
				<div
					class="card card_body shadow p-5 py-2 bg-body-tertiary rounded border-0"
				>
					<div class="card_header">
						<div class="row">
							<div
								th:text="${servicio.categoria.nombre}"
								class="text-center text-primary fs-4 pt-4 pb-1"
							></div>
						</div>
						<div class="row align-self-center border-top border-primary py-3">
							<div class="col-6 align-self-end">
								<img
									th:if="${servicio.proveedor.imagen != null}"
									th:src="@{/imagen/usuario/__${servicio.proveedor.id}__}"
									class="img_perfil align-self-end"
									alt="imagen de perfil"
								/>
							</div>
							<div
								th:text="${servicio.proveedor.nombre}"
								class="col-6 align-self-center fs-5"
							></div>
						</div>
						<div class="row border-top border-primary">
							<div
								th:text="${servicio.descripcion}"
								class="text-secundary descripcion-card py-2"
							></div>
						</div>
						<div
							th:if="${servicio.matricula != null}"
							class="row border-top border-primary"
						>
							<div class="col-7 py-2">Matricula:</div>
							<div class="col-5 py-2">
								<button
									class="btn btn-sm boton-card"
									data-bs-toggle="modal"
									th:data-bs-target="'#exampleModal_' + ${iterStat.index}"
								>
									Ver Matricula
								</button>
							</div>
						</div>
						<!-- =========================== MODAL VER MATRICULA =========================== -->
						<div
							class="modal fade"
							th:id="'exampleModal_' + ${iterStat.index}"
							tabindex="-1"
							aria-labelledby="exampleModalLabel"
							aria-hidden="true"
						>
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h1 class="modal-title fs-5" id="exampleModalLabel">
											Matricula profesional
										</h1>
										<button
											type="button"
											class="btn-close"
											data-bs-dismiss="modal"
											aria-label="Close"
										></button>
									</div>
									<div class="modal-body text-center">
										<img
											th:src="@{/imagen/matricula/__${servicio.id}__}"
											class="img-matricula"
											alt="imagen de matricula"
										/>
									</div>
									<div class="modal-footer">
										<button
											type="button"
											class="btn btn-secondary"
											data-bs-dismiss="modal"
										>
											Close
										</button>
									</div>
								</div>
							</div>
						</div>

						<div class="row border-top border-primary">
							<div class="col-7 py-2">Honorarios p/ hora:</div>
							<div class="col-5 py-2">
								<b>$</b><b th:text="${servicio.honorariosHora}"></b>
							</div>
						</div>
						<div class="row border-top py-2">
							<div class="col-7 align-self-end">Calificaci√≥n Proveedor:</div>
							<div class="col-5">
								<b>
									<i
										th:each="estrellita : ${#numbers.sequence(1, 5)}"
										th:class="${estrellita le puntuaciones[iterStat.index]} ? 'bi bi-star-fill' : 'bi bi-star'"
									></i>
								</b>
							</div>
						</div>
						<div class="row border-top py-2">
							<div class="col-12 py-2 text-center">
								<button
									class="btn btn-sm boton-card"
									data-bs-toggle="modal"
									th:data-bs-target="'#ofertaModal_' + ${iterStat.index}">
									Contratar
								</button>
							</div>
						</div>
						<!-- =========================== MODAL CONTRATAR SERVICIO =========================== -->
						<div
								class="modal fade"
								th:id="'ofertaModal_' + ${iterStat.index}"
								tabindex="-1"
								aria-labelledby="exampleModalLabel"
								aria-hidden="true"
						>
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h1 class="modal-title fs-5" id="exampleModalLabel">
											Contratar Servicio
										</h1>
										<button
												type="button"
												class="btn-close"
												data-bs-dismiss="modal"
												aria-label="Close"
										></button>
									</div>
									<div class="modal-body text-center">
										<h4 class="modal-title">Registrar Oferta</h4>
										<form id="form-oferta" method="dialog" action="">
											<label for="idServicio">ID Servicio</label>
											<input type="text" name="idServicio" id="idServicio" th:value="${servicio.id}" readonly>
											<label for="descripcion">Descripcion</label>
											<textarea rows="4" style="resize: none;" name="descripcion" id="descripcion" required></textarea>

											<button class="btn-oferta" type="submit">Ofertar</button>
										</form>
									</div>
									<div class="modal-footer">
										<button
												type="button"
												class="btn btn-secondary"
												data-bs-dismiss="modal"
										>
											Close
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- =========================== CSS =========================== -->
		<style>
			.cerrar-modal {
				border-style: none;
				float: right;
				border-radius: 5px;
				margin: 0;
			}
			.cerrar-modal:hover {
				filter: brightness(0.8);
			}

			#modal-oferta {
				width: 60%;
				border-radius: 20px;
				border-style: none;
			}
			#modal-oferta label,
			input,
			textarea {
				width: 100%;
			}
		</style>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
				integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
				crossorigin="anonymous"></script>
	</body>
</html>
